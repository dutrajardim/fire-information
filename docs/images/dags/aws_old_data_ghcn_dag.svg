<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 3.0.0 (0)
 -->
<!-- Title: aws_old_data_ghcn_dag Pages: 1 -->
<svg width="1614pt" height="259pt"
 viewBox="0.00 0.00 1614.00 259.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 255)">
<title>aws_old_data_ghcn_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-255 1610,-255 1610,4 -4,4"/>
<text text-anchor="middle" x="803" y="-235.8" font-family="Times,serif" font-size="14.00">aws_old_data_ghcn_dag</text>
<g id="clust1" class="cluster">
<title>cluster_load_ghcn_data</title>
<polygon fill="#6495ed" fill-opacity="0.498039" stroke="#000000" points="134,-145 134,-220 481.5,-220 481.5,-145 134,-145"/>
<text text-anchor="middle" x="307.75" y="-204.8" font-family="Times,serif" font-size="14.00">load_ghcn_data</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_load_script_files</title>
<polygon fill="#6495ed" fill-opacity="0.498039" stroke="#000000" points="134,-8 134,-137 587,-137 587,-8 134,-8"/>
<text text-anchor="middle" x="360.5" y="-121.8" font-family="Times,serif" font-size="14.00">load_script_files</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_run_quality_tests</title>
<polygon fill="#6495ed" fill-opacity="0.498039" stroke="#000000" points="1234,-95 1234,-170 1480,-170 1480,-95 1234,-95"/>
<text text-anchor="middle" x="1357" y="-154.8" font-family="Times,serif" font-size="14.00">run_quality_tests</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_submit_spark_to_emr</title>
<polygon fill="#6495ed" fill-opacity="0.498039" stroke="#000000" points="607,-95 607,-170 1214,-170 1214,-95 607,-95"/>
<text text-anchor="middle" x="910.5" y="-154.8" font-family="Times,serif" font-size="14.00">submit_spark_to_emr</text>
</g>
<!-- begin_execution -->
<g id="node1" class="node">
<title>begin_execution</title>
<path fill="#e8f7e4" stroke="#000000" d="M94,-149C94,-149 12,-149 12,-149 6,-149 0,-143 0,-137 0,-137 0,-125 0,-125 0,-119 6,-113 12,-113 12,-113 94,-113 94,-113 100,-113 106,-119 106,-125 106,-125 106,-137 106,-137 106,-143 100,-149 94,-149"/>
<text text-anchor="middle" x="53" y="-127.3" font-family="Times,serif" font-size="14.00">begin_execution</text>
</g>
<!-- load_ghcn_data.upstream_join_id -->
<g id="node2" class="node">
<title>load_ghcn_data.upstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="149" cy="-165" rx="7" ry="7"/>
</g>
<!-- begin_execution&#45;&gt;load_ghcn_data.upstream_join_id -->
<g id="edge1" class="edge">
<title>begin_execution&#45;&gt;load_ghcn_data.upstream_join_id</title>
<path fill="none" stroke="black" d="M104.03,-149.1C114.4,-152.85 124.57,-156.53 132.52,-159.4"/>
<polygon fill="black" stroke="black" points="131.46,-162.74 142.05,-162.85 133.84,-156.16 131.46,-162.74"/>
</g>
<!-- load_script_files.upstream_join_id -->
<g id="node5" class="node">
<title>load_script_files.upstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="149" cy="-93" rx="7" ry="7"/>
</g>
<!-- begin_execution&#45;&gt;load_script_files.upstream_join_id -->
<g id="edge2" class="edge">
<title>begin_execution&#45;&gt;load_script_files.upstream_join_id</title>
<path fill="none" stroke="black" d="M98.8,-112.89C111.17,-107.89 123.74,-102.81 133.08,-99.03"/>
<polygon fill="black" stroke="black" points="134.4,-102.27 142.36,-95.28 131.77,-95.78 134.4,-102.27"/>
</g>
<!-- load_ghcn_data.data_from_ghcn_to_s3_2021 -->
<g id="node4" class="node">
<title>load_ghcn_data.data_from_ghcn_to_s3_2021</title>
<path fill="#7545a1" stroke="#000000" d="M356,-189C356,-189 204,-189 204,-189 198,-189 192,-183 192,-177 192,-177 192,-165 192,-165 192,-159 198,-153 204,-153 204,-153 356,-153 356,-153 362,-153 368,-159 368,-165 368,-165 368,-177 368,-177 368,-183 362,-189 356,-189"/>
<text text-anchor="middle" x="280" y="-167.3" font-family="Times,serif" font-size="14.00">data_from_ghcn_to_s3_2021</text>
</g>
<!-- load_ghcn_data.upstream_join_id&#45;&gt;load_ghcn_data.data_from_ghcn_to_s3_2021 -->
<g id="edge5" class="edge">
<title>load_ghcn_data.upstream_join_id&#45;&gt;load_ghcn_data.data_from_ghcn_to_s3_2021</title>
<path fill="none" stroke="black" d="M156.22,-165.29C161.85,-165.55 170.87,-165.97 181.54,-166.47"/>
<polygon fill="black" stroke="black" points="181.59,-169.97 191.74,-166.94 181.92,-162.98 181.59,-169.97"/>
</g>
<!-- load_ghcn_data.downstream_join_id -->
<g id="node3" class="node">
<title>load_ghcn_data.downstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="466.5" cy="-165" rx="7" ry="7"/>
</g>
<!-- submit_spark_to_emr.upstream_join_id -->
<g id="node14" class="node">
<title>submit_spark_to_emr.upstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="622" cy="-121" rx="7" ry="7"/>
</g>
<!-- load_ghcn_data.downstream_join_id&#45;&gt;submit_spark_to_emr.upstream_join_id -->
<g id="edge4" class="edge">
<title>load_ghcn_data.downstream_join_id&#45;&gt;submit_spark_to_emr.upstream_join_id</title>
<path fill="none" stroke="black" d="M473.67,-164.49C491.67,-162.85 545.49,-156.86 587,-141 594.05,-138.31 601.33,-134.23 607.33,-130.45"/>
<polygon fill="black" stroke="black" points="609.6,-133.15 615.97,-124.69 605.71,-127.33 609.6,-133.15"/>
</g>
<!-- load_ghcn_data.data_from_ghcn_to_s3_2021&#45;&gt;load_ghcn_data.downstream_join_id -->
<g id="edge3" class="edge">
<title>load_ghcn_data.data_from_ghcn_to_s3_2021&#45;&gt;load_ghcn_data.downstream_join_id</title>
<path fill="none" stroke="black" d="M368.12,-168.17C399.04,-167.16 430.73,-166.13 449.24,-165.53"/>
<polygon fill="black" stroke="black" points="449.48,-169.02 459.36,-165.2 449.25,-162.03 449.48,-169.02"/>
</g>
<!-- load_script_files.start -->
<g id="node9" class="node">
<title>load_script_files.start</title>
<path fill="#e8f7e4" stroke="#000000" d="M295,-106C295,-106 265,-106 265,-106 259,-106 253,-100 253,-94 253,-94 253,-82 253,-82 253,-76 259,-70 265,-70 265,-70 295,-70 295,-70 301,-70 307,-76 307,-82 307,-82 307,-94 307,-94 307,-100 301,-106 295,-106"/>
<text text-anchor="middle" x="280" y="-84.3" font-family="Times,serif" font-size="14.00">start</text>
</g>
<!-- load_script_files.upstream_join_id&#45;&gt;load_script_files.start -->
<g id="edge11" class="edge">
<title>load_script_files.upstream_join_id&#45;&gt;load_script_files.start</title>
<path fill="none" stroke="black" d="M156.22,-92.76C171.57,-92.16 212.21,-90.59 242.56,-89.41"/>
<polygon fill="black" stroke="black" points="242.95,-92.9 252.81,-89.02 242.68,-85.91 242.95,-92.9"/>
</g>
<!-- load_script_files.downstream_join_id -->
<g id="node6" class="node">
<title>load_script_files.downstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="572" cy="-88" rx="7" ry="7"/>
</g>
<!-- load_script_files.downstream_join_id&#45;&gt;submit_spark_to_emr.upstream_join_id -->
<g id="edge7" class="edge">
<title>load_script_files.downstream_join_id&#45;&gt;submit_spark_to_emr.upstream_join_id</title>
<path fill="none" stroke="black" d="M578.14,-91.53C585.03,-96.27 597.53,-104.86 607.26,-111.55"/>
<polygon fill="black" stroke="black" points="605.53,-114.61 615.75,-117.39 609.5,-108.84 605.53,-114.61"/>
</g>
<!-- load_script_files.bootstrap&#45;actions.sh -->
<g id="node7" class="node">
<title>load_script_files.bootstrap&#45;actions.sh</title>
<path fill="#7545a1" stroke="#000000" d="M517,-52C517,-52 416,-52 416,-52 410,-52 404,-46 404,-40 404,-40 404,-28 404,-28 404,-22 410,-16 416,-16 416,-16 517,-16 517,-16 523,-16 529,-22 529,-28 529,-28 529,-40 529,-40 529,-46 523,-52 517,-52"/>
<text text-anchor="middle" x="466.5" y="-30.3" font-family="Times,serif" font-size="14.00">bootstrap&#45;actions.sh</text>
</g>
<!-- load_script_files.bootstrap&#45;actions.sh&#45;&gt;load_script_files.downstream_join_id -->
<g id="edge6" class="edge">
<title>load_script_files.bootstrap&#45;actions.sh&#45;&gt;load_script_files.downstream_join_id</title>
<path fill="none" stroke="black" d="M510.92,-52.04C517.07,-54.88 523.25,-57.91 529,-61 538.88,-66.3 549.51,-73.14 557.59,-78.61"/>
<polygon fill="black" stroke="black" points="555.77,-81.6 565.99,-84.41 559.75,-75.84 555.77,-81.6"/>
</g>
<!-- load_script_files.ghcn_spark_etl.py -->
<g id="node8" class="node">
<title>load_script_files.ghcn_spark_etl.py</title>
<path fill="#7545a1" stroke="#000000" d="M512.5,-106C512.5,-106 420.5,-106 420.5,-106 414.5,-106 408.5,-100 408.5,-94 408.5,-94 408.5,-82 408.5,-82 408.5,-76 414.5,-70 420.5,-70 420.5,-70 512.5,-70 512.5,-70 518.5,-70 524.5,-76 524.5,-82 524.5,-82 524.5,-94 524.5,-94 524.5,-100 518.5,-106 512.5,-106"/>
<text text-anchor="middle" x="466.5" y="-84.3" font-family="Times,serif" font-size="14.00">ghcn_spark_etl.py</text>
</g>
<!-- load_script_files.ghcn_spark_etl.py&#45;&gt;load_script_files.downstream_join_id -->
<g id="edge8" class="edge">
<title>load_script_files.ghcn_spark_etl.py&#45;&gt;load_script_files.downstream_join_id</title>
<path fill="none" stroke="black" d="M524.7,-88C535.63,-88 546.23,-88 554.53,-88"/>
<polygon fill="black" stroke="black" points="554.8,-91.5 564.8,-88 554.8,-84.5 554.8,-91.5"/>
</g>
<!-- load_script_files.start&#45;&gt;load_script_files.bootstrap&#45;actions.sh -->
<g id="edge9" class="edge">
<title>load_script_files.start&#45;&gt;load_script_files.bootstrap&#45;actions.sh</title>
<path fill="none" stroke="black" d="M307.04,-80.38C329.63,-73.77 363.41,-63.88 393.98,-54.93"/>
<polygon fill="black" stroke="black" points="395.17,-58.23 403.78,-52.06 393.2,-51.51 395.17,-58.23"/>
</g>
<!-- load_script_files.start&#45;&gt;load_script_files.ghcn_spark_etl.py -->
<g id="edge10" class="edge">
<title>load_script_files.start&#45;&gt;load_script_files.ghcn_spark_etl.py</title>
<path fill="none" stroke="black" d="M307.04,-88C330.71,-88 366.65,-88 398.33,-88"/>
<polygon fill="black" stroke="black" points="398.44,-91.5 408.44,-88 398.44,-84.5 398.44,-91.5"/>
</g>
<!-- run_quality_tests.upstream_join_id -->
<g id="node10" class="node">
<title>run_quality_tests.upstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="1249" cy="-121" rx="7" ry="7"/>
</g>
<!-- run_quality_tests.check_if_data_exists -->
<g id="node12" class="node">
<title>run_quality_tests.check_if_data_exists</title>
<path fill="#89da59" stroke="#000000" d="M1410,-139C1410,-139 1304,-139 1304,-139 1298,-139 1292,-133 1292,-127 1292,-127 1292,-115 1292,-115 1292,-109 1298,-103 1304,-103 1304,-103 1410,-103 1410,-103 1416,-103 1422,-109 1422,-115 1422,-115 1422,-127 1422,-127 1422,-133 1416,-139 1410,-139"/>
<text text-anchor="middle" x="1357" y="-117.3" font-family="Times,serif" font-size="14.00">check_if_data_exists</text>
</g>
<!-- run_quality_tests.upstream_join_id&#45;&gt;run_quality_tests.check_if_data_exists -->
<g id="edge14" class="edge">
<title>run_quality_tests.upstream_join_id&#45;&gt;run_quality_tests.check_if_data_exists</title>
<path fill="none" stroke="black" d="M1256,-121C1261.74,-121 1271.08,-121 1281.8,-121"/>
<polygon fill="black" stroke="black" points="1281.98,-124.5 1291.98,-121 1281.98,-117.5 1281.98,-124.5"/>
</g>
<!-- run_quality_tests.downstream_join_id -->
<g id="node11" class="node">
<title>run_quality_tests.downstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="1465" cy="-121" rx="7" ry="7"/>
</g>
<!-- stop_execution -->
<g id="node13" class="node">
<title>stop_execution</title>
<path fill="#e8f7e4" stroke="#000000" d="M1594,-139C1594,-139 1520,-139 1520,-139 1514,-139 1508,-133 1508,-127 1508,-127 1508,-115 1508,-115 1508,-109 1514,-103 1520,-103 1520,-103 1594,-103 1594,-103 1600,-103 1606,-109 1606,-115 1606,-115 1606,-127 1606,-127 1606,-133 1600,-139 1594,-139"/>
<text text-anchor="middle" x="1557" y="-117.3" font-family="Times,serif" font-size="14.00">stop_execution</text>
</g>
<!-- run_quality_tests.downstream_join_id&#45;&gt;stop_execution -->
<g id="edge13" class="edge">
<title>run_quality_tests.downstream_join_id&#45;&gt;stop_execution</title>
<path fill="none" stroke="black" d="M1472.19,-121C1477.96,-121 1487.23,-121 1497.53,-121"/>
<polygon fill="black" stroke="black" points="1497.64,-124.5 1507.64,-121 1497.64,-117.5 1497.64,-124.5"/>
</g>
<!-- run_quality_tests.check_if_data_exists&#45;&gt;run_quality_tests.downstream_join_id -->
<g id="edge12" class="edge">
<title>run_quality_tests.check_if_data_exists&#45;&gt;run_quality_tests.downstream_join_id</title>
<path fill="none" stroke="black" d="M1422.11,-121C1431.49,-121 1440.39,-121 1447.55,-121"/>
<polygon fill="black" stroke="black" points="1447.75,-124.5 1457.75,-121 1447.75,-117.5 1447.75,-124.5"/>
</g>
<!-- submit_spark_to_emr.create_cluster -->
<g id="node17" class="node">
<title>submit_spark_to_emr.create_cluster</title>
<path fill="#f9c915" stroke="#000000" d="M745,-139C745,-139 677,-139 677,-139 671,-139 665,-133 665,-127 665,-127 665,-115 665,-115 665,-109 671,-103 677,-103 677,-103 745,-103 745,-103 751,-103 757,-109 757,-115 757,-115 757,-127 757,-127 757,-133 751,-139 745,-139"/>
<text text-anchor="middle" x="711" y="-117.3" font-family="Times,serif" font-size="14.00">create_cluster</text>
</g>
<!-- submit_spark_to_emr.upstream_join_id&#45;&gt;submit_spark_to_emr.create_cluster -->
<g id="edge19" class="edge">
<title>submit_spark_to_emr.upstream_join_id&#45;&gt;submit_spark_to_emr.create_cluster</title>
<path fill="none" stroke="black" d="M629.26,-121C635.1,-121 644.46,-121 654.76,-121"/>
<polygon fill="black" stroke="black" points="654.85,-124.5 664.85,-121 654.85,-117.5 654.85,-124.5"/>
</g>
<!-- submit_spark_to_emr.downstream_join_id -->
<g id="node15" class="node">
<title>submit_spark_to_emr.downstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="1199" cy="-121" rx="7" ry="7"/>
</g>
<!-- submit_spark_to_emr.downstream_join_id&#45;&gt;run_quality_tests.upstream_join_id -->
<g id="edge17" class="edge">
<title>submit_spark_to_emr.downstream_join_id&#45;&gt;run_quality_tests.upstream_join_id</title>
<path fill="none" stroke="black" d="M1206.28,-121C1212.71,-121 1222.98,-121 1231.72,-121"/>
<polygon fill="black" stroke="black" points="1231.88,-124.5 1241.88,-121 1231.88,-117.5 1231.88,-124.5"/>
</g>
<!-- submit_spark_to_emr.add_steps -->
<g id="node16" class="node">
<title>submit_spark_to_emr.add_steps</title>
<path fill="#f9c915" stroke="#000000" d="M851,-139C851,-139 805,-139 805,-139 799,-139 793,-133 793,-127 793,-127 793,-115 793,-115 793,-109 799,-103 805,-103 805,-103 851,-103 851,-103 857,-103 863,-109 863,-115 863,-115 863,-127 863,-127 863,-133 857,-139 851,-139"/>
<text text-anchor="middle" x="828" y="-117.3" font-family="Times,serif" font-size="14.00">add_steps</text>
</g>
<!-- submit_spark_to_emr.watch_ghcn_step -->
<g id="node19" class="node">
<title>submit_spark_to_emr.watch_ghcn_step</title>
<path fill="#66c3ff" stroke="#000000" d="M997,-139C997,-139 911,-139 911,-139 905,-139 899,-133 899,-127 899,-127 899,-115 899,-115 899,-109 905,-103 911,-103 911,-103 997,-103 997,-103 1003,-103 1009,-109 1009,-115 1009,-115 1009,-127 1009,-127 1009,-133 1003,-139 997,-139"/>
<text text-anchor="middle" x="954" y="-117.3" font-family="Times,serif" font-size="14.00">watch_ghcn_step</text>
</g>
<!-- submit_spark_to_emr.add_steps&#45;&gt;submit_spark_to_emr.watch_ghcn_step -->
<g id="edge15" class="edge">
<title>submit_spark_to_emr.add_steps&#45;&gt;submit_spark_to_emr.watch_ghcn_step</title>
<path fill="none" stroke="black" d="M863.21,-121C871.15,-121 879.85,-121 888.61,-121"/>
<polygon fill="black" stroke="black" points="888.89,-124.5 898.89,-121 888.89,-117.5 888.89,-124.5"/>
</g>
<!-- submit_spark_to_emr.create_cluster&#45;&gt;submit_spark_to_emr.add_steps -->
<g id="edge16" class="edge">
<title>submit_spark_to_emr.create_cluster&#45;&gt;submit_spark_to_emr.add_steps</title>
<path fill="none" stroke="black" d="M757.12,-121C765.44,-121 774.12,-121 782.42,-121"/>
<polygon fill="black" stroke="black" points="782.68,-124.5 792.68,-121 782.68,-117.5 782.68,-124.5"/>
</g>
<!-- submit_spark_to_emr.terminate_cluster -->
<g id="node18" class="node">
<title>submit_spark_to_emr.terminate_cluster</title>
<path fill="#f9c915" stroke="#000000" d="M1144,-139C1144,-139 1057,-139 1057,-139 1051,-139 1045,-133 1045,-127 1045,-127 1045,-115 1045,-115 1045,-109 1051,-103 1057,-103 1057,-103 1144,-103 1144,-103 1150,-103 1156,-109 1156,-115 1156,-115 1156,-127 1156,-127 1156,-133 1150,-139 1144,-139"/>
<text text-anchor="middle" x="1100.5" y="-117.3" font-family="Times,serif" font-size="14.00">terminate_cluster</text>
</g>
<!-- submit_spark_to_emr.terminate_cluster&#45;&gt;submit_spark_to_emr.downstream_join_id -->
<g id="edge18" class="edge">
<title>submit_spark_to_emr.terminate_cluster&#45;&gt;submit_spark_to_emr.downstream_join_id</title>
<path fill="none" stroke="black" d="M1156.23,-121C1165.61,-121 1174.66,-121 1181.92,-121"/>
<polygon fill="black" stroke="black" points="1181.92,-124.5 1191.92,-121 1181.92,-117.5 1181.92,-124.5"/>
</g>
<!-- submit_spark_to_emr.watch_ghcn_step&#45;&gt;submit_spark_to_emr.terminate_cluster -->
<g id="edge20" class="edge">
<title>submit_spark_to_emr.watch_ghcn_step&#45;&gt;submit_spark_to_emr.terminate_cluster</title>
<path fill="none" stroke="black" d="M1009.22,-121C1017.62,-121 1026.37,-121 1034.98,-121"/>
<polygon fill="black" stroke="black" points="1034.98,-124.5 1044.98,-121 1034.98,-117.5 1034.98,-124.5"/>
</g>
</g>
</svg>
