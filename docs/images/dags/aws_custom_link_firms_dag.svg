<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 3.0.0 (0)
 -->
<!-- Title: aws_custom_link_firms_dag Pages: 1 -->
<svg width="1503pt" height="259pt"
 viewBox="0.00 0.00 1503.00 259.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 255)">
<title>aws_custom_link_firms_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-255 1499,-255 1499,4 -4,4"/>
<text text-anchor="middle" x="747.5" y="-235.8" font-family="Times,serif" font-size="14.00">aws_custom_link_firms_dag</text>
<g id="clust1" class="cluster">
<title>cluster_load_firms_data</title>
<polygon fill="#6495ed" fill-opacity="0.498039" stroke="#000000" points="134,-145 134,-220 370.5,-220 370.5,-145 134,-145"/>
<text text-anchor="middle" x="252.25" y="-204.8" font-family="Times,serif" font-size="14.00">load_firms_data</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_load_script_files</title>
<polygon fill="#6495ed" fill-opacity="0.498039" stroke="#000000" points="134,-8 134,-137 476,-137 476,-8 134,-8"/>
<text text-anchor="middle" x="305" y="-121.8" font-family="Times,serif" font-size="14.00">load_script_files</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_run_quality_tests</title>
<polygon fill="#6495ed" fill-opacity="0.498039" stroke="#000000" points="1126,-95 1126,-170 1372,-170 1372,-95 1126,-95"/>
<text text-anchor="middle" x="1249" y="-154.8" font-family="Times,serif" font-size="14.00">run_quality_tests</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_submit_spark_to_emr</title>
<polygon fill="#6495ed" fill-opacity="0.498039" stroke="#000000" points="496,-95 496,-170 1106,-170 1106,-95 496,-95"/>
<text text-anchor="middle" x="801" y="-154.8" font-family="Times,serif" font-size="14.00">submit_spark_to_emr</text>
</g>
<!-- begin_execution -->
<g id="node1" class="node">
<title>begin_execution</title>
<path fill="#e8f7e4" stroke="#000000" d="M94,-149C94,-149 12,-149 12,-149 6,-149 0,-143 0,-137 0,-137 0,-125 0,-125 0,-119 6,-113 12,-113 12,-113 94,-113 94,-113 100,-113 106,-119 106,-125 106,-125 106,-137 106,-137 106,-143 100,-149 94,-149"/>
<text text-anchor="middle" x="53" y="-127.3" font-family="Times,serif" font-size="14.00">begin_execution</text>
</g>
<!-- load_firms_data.upstream_join_id -->
<g id="node3" class="node">
<title>load_firms_data.upstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="149" cy="-165" rx="7" ry="7"/>
</g>
<!-- begin_execution&#45;&gt;load_firms_data.upstream_join_id -->
<g id="edge1" class="edge">
<title>begin_execution&#45;&gt;load_firms_data.upstream_join_id</title>
<path fill="none" stroke="black" d="M104.03,-149.1C114.4,-152.85 124.57,-156.53 132.52,-159.4"/>
<polygon fill="black" stroke="black" points="131.46,-162.74 142.05,-162.85 133.84,-156.16 131.46,-162.74"/>
</g>
<!-- load_script_files.upstream_join_id -->
<g id="node6" class="node">
<title>load_script_files.upstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="149" cy="-93" rx="7" ry="7"/>
</g>
<!-- begin_execution&#45;&gt;load_script_files.upstream_join_id -->
<g id="edge2" class="edge">
<title>begin_execution&#45;&gt;load_script_files.upstream_join_id</title>
<path fill="none" stroke="black" d="M98.8,-112.89C111.17,-107.89 123.74,-102.81 133.08,-99.03"/>
<polygon fill="black" stroke="black" points="134.4,-102.27 142.36,-95.28 131.77,-95.78 134.4,-102.27"/>
</g>
<!-- end_execution -->
<g id="node2" class="node">
<title>end_execution</title>
<path fill="#e8f7e4" stroke="#000000" d="M1483,-139C1483,-139 1412,-139 1412,-139 1406,-139 1400,-133 1400,-127 1400,-127 1400,-115 1400,-115 1400,-109 1406,-103 1412,-103 1412,-103 1483,-103 1483,-103 1489,-103 1495,-109 1495,-115 1495,-115 1495,-127 1495,-127 1495,-133 1489,-139 1483,-139"/>
<text text-anchor="middle" x="1447.5" y="-117.3" font-family="Times,serif" font-size="14.00">end_execution</text>
</g>
<!-- load_firms_data.load_file -->
<g id="node5" class="node">
<title>load_firms_data.load_file</title>
<path fill="#7545a1" stroke="#000000" d="M245,-189C245,-189 204,-189 204,-189 198,-189 192,-183 192,-177 192,-177 192,-165 192,-165 192,-159 198,-153 204,-153 204,-153 245,-153 245,-153 251,-153 257,-159 257,-165 257,-165 257,-177 257,-177 257,-183 251,-189 245,-189"/>
<text text-anchor="middle" x="224.5" y="-167.3" font-family="Times,serif" font-size="14.00">load_file</text>
</g>
<!-- load_firms_data.upstream_join_id&#45;&gt;load_firms_data.load_file -->
<g id="edge5" class="edge">
<title>load_firms_data.upstream_join_id&#45;&gt;load_firms_data.load_file</title>
<path fill="none" stroke="black" d="M156.27,-165.51C162.2,-166 171.67,-166.77 181.66,-167.58"/>
<polygon fill="black" stroke="black" points="181.44,-171.08 191.7,-168.4 182.01,-164.1 181.44,-171.08"/>
</g>
<!-- load_firms_data.downstream_join_id -->
<g id="node4" class="node">
<title>load_firms_data.downstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="355.5" cy="-165" rx="7" ry="7"/>
</g>
<!-- submit_spark_to_emr.upstream_join_id -->
<g id="node14" class="node">
<title>submit_spark_to_emr.upstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="511" cy="-121" rx="7" ry="7"/>
</g>
<!-- load_firms_data.downstream_join_id&#45;&gt;submit_spark_to_emr.upstream_join_id -->
<g id="edge3" class="edge">
<title>load_firms_data.downstream_join_id&#45;&gt;submit_spark_to_emr.upstream_join_id</title>
<path fill="none" stroke="black" d="M362.67,-164.49C380.67,-162.85 434.49,-156.86 476,-141 483.05,-138.31 490.33,-134.23 496.33,-130.45"/>
<polygon fill="black" stroke="black" points="498.6,-133.15 504.97,-124.69 494.71,-127.33 498.6,-133.15"/>
</g>
<!-- load_firms_data.load_file&#45;&gt;load_firms_data.downstream_join_id -->
<g id="edge4" class="edge">
<title>load_firms_data.load_file&#45;&gt;load_firms_data.downstream_join_id</title>
<path fill="none" stroke="black" d="M257.06,-169.53C282.75,-168.34 317.97,-166.7 338.27,-165.75"/>
<polygon fill="black" stroke="black" points="338.49,-169.25 348.32,-165.29 338.17,-162.26 338.49,-169.25"/>
</g>
<!-- load_script_files.start -->
<g id="node10" class="node">
<title>load_script_files.start</title>
<path fill="#e8f7e4" stroke="#000000" d="M239.5,-106C239.5,-106 209.5,-106 209.5,-106 203.5,-106 197.5,-100 197.5,-94 197.5,-94 197.5,-82 197.5,-82 197.5,-76 203.5,-70 209.5,-70 209.5,-70 239.5,-70 239.5,-70 245.5,-70 251.5,-76 251.5,-82 251.5,-82 251.5,-94 251.5,-94 251.5,-100 245.5,-106 239.5,-106"/>
<text text-anchor="middle" x="224.5" y="-84.3" font-family="Times,serif" font-size="14.00">start</text>
</g>
<!-- load_script_files.upstream_join_id&#45;&gt;load_script_files.start -->
<g id="edge11" class="edge">
<title>load_script_files.upstream_join_id&#45;&gt;load_script_files.start</title>
<path fill="none" stroke="black" d="M156.27,-92.57C163.25,-92.1 175.12,-91.29 186.96,-90.49"/>
<polygon fill="black" stroke="black" points="187.49,-93.96 197.23,-89.79 187.02,-86.97 187.49,-93.96"/>
</g>
<!-- load_script_files.downstream_join_id -->
<g id="node7" class="node">
<title>load_script_files.downstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="461" cy="-88" rx="7" ry="7"/>
</g>
<!-- load_script_files.downstream_join_id&#45;&gt;submit_spark_to_emr.upstream_join_id -->
<g id="edge7" class="edge">
<title>load_script_files.downstream_join_id&#45;&gt;submit_spark_to_emr.upstream_join_id</title>
<path fill="none" stroke="black" d="M467.14,-91.53C474.03,-96.27 486.53,-104.86 496.26,-111.55"/>
<polygon fill="black" stroke="black" points="494.53,-114.61 504.75,-117.39 498.5,-108.84 494.53,-114.61"/>
</g>
<!-- load_script_files.bootstrap&#45;actions.sh -->
<g id="node8" class="node">
<title>load_script_files.bootstrap&#45;actions.sh</title>
<path fill="#7545a1" stroke="#000000" d="M406,-52C406,-52 305,-52 305,-52 299,-52 293,-46 293,-40 293,-40 293,-28 293,-28 293,-22 299,-16 305,-16 305,-16 406,-16 406,-16 412,-16 418,-22 418,-28 418,-28 418,-40 418,-40 418,-46 412,-52 406,-52"/>
<text text-anchor="middle" x="355.5" y="-30.3" font-family="Times,serif" font-size="14.00">bootstrap&#45;actions.sh</text>
</g>
<!-- load_script_files.bootstrap&#45;actions.sh&#45;&gt;load_script_files.downstream_join_id -->
<g id="edge6" class="edge">
<title>load_script_files.bootstrap&#45;actions.sh&#45;&gt;load_script_files.downstream_join_id</title>
<path fill="none" stroke="black" d="M399.92,-52.04C406.07,-54.88 412.25,-57.91 418,-61 427.88,-66.3 438.51,-73.14 446.59,-78.61"/>
<polygon fill="black" stroke="black" points="444.77,-81.6 454.99,-84.41 448.75,-75.84 444.77,-81.6"/>
</g>
<!-- load_script_files.firms_spark_etl.py -->
<g id="node9" class="node">
<title>load_script_files.firms_spark_etl.py</title>
<path fill="#7545a1" stroke="#000000" d="M403,-106C403,-106 308,-106 308,-106 302,-106 296,-100 296,-94 296,-94 296,-82 296,-82 296,-76 302,-70 308,-70 308,-70 403,-70 403,-70 409,-70 415,-76 415,-82 415,-82 415,-94 415,-94 415,-100 409,-106 403,-106"/>
<text text-anchor="middle" x="355.5" y="-84.3" font-family="Times,serif" font-size="14.00">firms_spark_etl.py</text>
</g>
<!-- load_script_files.firms_spark_etl.py&#45;&gt;load_script_files.downstream_join_id -->
<g id="edge8" class="edge">
<title>load_script_files.firms_spark_etl.py&#45;&gt;load_script_files.downstream_join_id</title>
<path fill="none" stroke="black" d="M415.21,-88C425.63,-88 435.67,-88 443.59,-88"/>
<polygon fill="black" stroke="black" points="443.77,-91.5 453.77,-88 443.77,-84.5 443.77,-91.5"/>
</g>
<!-- load_script_files.start&#45;&gt;load_script_files.bootstrap&#45;actions.sh -->
<g id="edge9" class="edge">
<title>load_script_files.start&#45;&gt;load_script_files.bootstrap&#45;actions.sh</title>
<path fill="none" stroke="black" d="M251.61,-77.07C266.08,-71.01 284.61,-63.26 301.94,-56"/>
<polygon fill="black" stroke="black" points="303.55,-59.12 311.42,-52.03 300.84,-52.67 303.55,-59.12"/>
</g>
<!-- load_script_files.start&#45;&gt;load_script_files.firms_spark_etl.py -->
<g id="edge10" class="edge">
<title>load_script_files.start&#45;&gt;load_script_files.firms_spark_etl.py</title>
<path fill="none" stroke="black" d="M251.61,-88C261.61,-88 273.56,-88 285.71,-88"/>
<polygon fill="black" stroke="black" points="285.93,-91.5 295.93,-88 285.93,-84.5 285.93,-91.5"/>
</g>
<!-- run_quality_tests.upstream_join_id -->
<g id="node11" class="node">
<title>run_quality_tests.upstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="1141" cy="-121" rx="7" ry="7"/>
</g>
<!-- run_quality_tests.check_if_data_exists -->
<g id="node13" class="node">
<title>run_quality_tests.check_if_data_exists</title>
<path fill="#89da59" stroke="#000000" d="M1302,-139C1302,-139 1196,-139 1196,-139 1190,-139 1184,-133 1184,-127 1184,-127 1184,-115 1184,-115 1184,-109 1190,-103 1196,-103 1196,-103 1302,-103 1302,-103 1308,-103 1314,-109 1314,-115 1314,-115 1314,-127 1314,-127 1314,-133 1308,-139 1302,-139"/>
<text text-anchor="middle" x="1249" y="-117.3" font-family="Times,serif" font-size="14.00">check_if_data_exists</text>
</g>
<!-- run_quality_tests.upstream_join_id&#45;&gt;run_quality_tests.check_if_data_exists -->
<g id="edge14" class="edge">
<title>run_quality_tests.upstream_join_id&#45;&gt;run_quality_tests.check_if_data_exists</title>
<path fill="none" stroke="black" d="M1148,-121C1153.74,-121 1163.08,-121 1173.8,-121"/>
<polygon fill="black" stroke="black" points="1173.98,-124.5 1183.98,-121 1173.98,-117.5 1173.98,-124.5"/>
</g>
<!-- run_quality_tests.downstream_join_id -->
<g id="node12" class="node">
<title>run_quality_tests.downstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="1357" cy="-121" rx="7" ry="7"/>
</g>
<!-- run_quality_tests.downstream_join_id&#45;&gt;end_execution -->
<g id="edge13" class="edge">
<title>run_quality_tests.downstream_join_id&#45;&gt;end_execution</title>
<path fill="none" stroke="black" d="M1364.08,-121C1369.88,-121 1379.25,-121 1389.64,-121"/>
<polygon fill="black" stroke="black" points="1389.82,-124.5 1399.82,-121 1389.82,-117.5 1389.82,-124.5"/>
</g>
<!-- run_quality_tests.check_if_data_exists&#45;&gt;run_quality_tests.downstream_join_id -->
<g id="edge12" class="edge">
<title>run_quality_tests.check_if_data_exists&#45;&gt;run_quality_tests.downstream_join_id</title>
<path fill="none" stroke="black" d="M1314.11,-121C1323.49,-121 1332.39,-121 1339.55,-121"/>
<polygon fill="black" stroke="black" points="1339.75,-124.5 1349.75,-121 1339.75,-117.5 1339.75,-124.5"/>
</g>
<!-- submit_spark_to_emr.create_cluster -->
<g id="node17" class="node">
<title>submit_spark_to_emr.create_cluster</title>
<path fill="#f9c915" stroke="#000000" d="M634,-139C634,-139 566,-139 566,-139 560,-139 554,-133 554,-127 554,-127 554,-115 554,-115 554,-109 560,-103 566,-103 566,-103 634,-103 634,-103 640,-103 646,-109 646,-115 646,-115 646,-127 646,-127 646,-133 640,-139 634,-139"/>
<text text-anchor="middle" x="600" y="-117.3" font-family="Times,serif" font-size="14.00">create_cluster</text>
</g>
<!-- submit_spark_to_emr.upstream_join_id&#45;&gt;submit_spark_to_emr.create_cluster -->
<g id="edge19" class="edge">
<title>submit_spark_to_emr.upstream_join_id&#45;&gt;submit_spark_to_emr.create_cluster</title>
<path fill="none" stroke="black" d="M518.26,-121C524.1,-121 533.46,-121 543.76,-121"/>
<polygon fill="black" stroke="black" points="543.85,-124.5 553.85,-121 543.85,-117.5 543.85,-124.5"/>
</g>
<!-- submit_spark_to_emr.downstream_join_id -->
<g id="node15" class="node">
<title>submit_spark_to_emr.downstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="1091" cy="-121" rx="7" ry="7"/>
</g>
<!-- submit_spark_to_emr.downstream_join_id&#45;&gt;run_quality_tests.upstream_join_id -->
<g id="edge17" class="edge">
<title>submit_spark_to_emr.downstream_join_id&#45;&gt;run_quality_tests.upstream_join_id</title>
<path fill="none" stroke="black" d="M1098.28,-121C1104.71,-121 1114.98,-121 1123.72,-121"/>
<polygon fill="black" stroke="black" points="1123.88,-124.5 1133.88,-121 1123.88,-117.5 1123.88,-124.5"/>
</g>
<!-- submit_spark_to_emr.add_steps -->
<g id="node16" class="node">
<title>submit_spark_to_emr.add_steps</title>
<path fill="#f9c915" stroke="#000000" d="M740,-139C740,-139 694,-139 694,-139 688,-139 682,-133 682,-127 682,-127 682,-115 682,-115 682,-109 688,-103 694,-103 694,-103 740,-103 740,-103 746,-103 752,-109 752,-115 752,-115 752,-127 752,-127 752,-133 746,-139 740,-139"/>
<text text-anchor="middle" x="717" y="-117.3" font-family="Times,serif" font-size="14.00">add_steps</text>
</g>
<!-- submit_spark_to_emr.watch_firms_step -->
<g id="node19" class="node">
<title>submit_spark_to_emr.watch_firms_step</title>
<path fill="#66c3ff" stroke="#000000" d="M889,-139C889,-139 800,-139 800,-139 794,-139 788,-133 788,-127 788,-127 788,-115 788,-115 788,-109 794,-103 800,-103 800,-103 889,-103 889,-103 895,-103 901,-109 901,-115 901,-115 901,-127 901,-127 901,-133 895,-139 889,-139"/>
<text text-anchor="middle" x="844.5" y="-117.3" font-family="Times,serif" font-size="14.00">watch_firms_step</text>
</g>
<!-- submit_spark_to_emr.add_steps&#45;&gt;submit_spark_to_emr.watch_firms_step -->
<g id="edge15" class="edge">
<title>submit_spark_to_emr.add_steps&#45;&gt;submit_spark_to_emr.watch_firms_step</title>
<path fill="none" stroke="black" d="M752.29,-121C760.31,-121 769.11,-121 777.98,-121"/>
<polygon fill="black" stroke="black" points="778,-124.5 788,-121 778,-117.5 778,-124.5"/>
</g>
<!-- submit_spark_to_emr.create_cluster&#45;&gt;submit_spark_to_emr.add_steps -->
<g id="edge16" class="edge">
<title>submit_spark_to_emr.create_cluster&#45;&gt;submit_spark_to_emr.add_steps</title>
<path fill="none" stroke="black" d="M646.12,-121C654.44,-121 663.12,-121 671.42,-121"/>
<polygon fill="black" stroke="black" points="671.68,-124.5 681.68,-121 671.68,-117.5 671.68,-124.5"/>
</g>
<!-- submit_spark_to_emr.terminate_cluster -->
<g id="node18" class="node">
<title>submit_spark_to_emr.terminate_cluster</title>
<path fill="#f9c915" stroke="#000000" d="M1036,-139C1036,-139 949,-139 949,-139 943,-139 937,-133 937,-127 937,-127 937,-115 937,-115 937,-109 943,-103 949,-103 949,-103 1036,-103 1036,-103 1042,-103 1048,-109 1048,-115 1048,-115 1048,-127 1048,-127 1048,-133 1042,-139 1036,-139"/>
<text text-anchor="middle" x="992.5" y="-117.3" font-family="Times,serif" font-size="14.00">terminate_cluster</text>
</g>
<!-- submit_spark_to_emr.terminate_cluster&#45;&gt;submit_spark_to_emr.downstream_join_id -->
<g id="edge18" class="edge">
<title>submit_spark_to_emr.terminate_cluster&#45;&gt;submit_spark_to_emr.downstream_join_id</title>
<path fill="none" stroke="black" d="M1048.23,-121C1057.61,-121 1066.66,-121 1073.92,-121"/>
<polygon fill="black" stroke="black" points="1073.92,-124.5 1083.92,-121 1073.92,-117.5 1073.92,-124.5"/>
</g>
<!-- submit_spark_to_emr.watch_firms_step&#45;&gt;submit_spark_to_emr.terminate_cluster -->
<g id="edge20" class="edge">
<title>submit_spark_to_emr.watch_firms_step&#45;&gt;submit_spark_to_emr.terminate_cluster</title>
<path fill="none" stroke="black" d="M901.11,-121C909.36,-121 917.93,-121 926.35,-121"/>
<polygon fill="black" stroke="black" points="926.52,-124.5 936.52,-121 926.52,-117.5 926.52,-124.5"/>
</g>
</g>
</svg>
