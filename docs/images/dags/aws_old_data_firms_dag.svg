<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 3.0.0 (0)
 -->
<!-- Title: aws_old_data_firms_dag Pages: 1 -->
<svg width="1536pt" height="259pt"
 viewBox="0.00 0.00 1536.00 259.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 255)">
<title>aws_old_data_firms_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-255 1532,-255 1532,4 -4,4"/>
<text text-anchor="middle" x="764" y="-235.8" font-family="Times,serif" font-size="14.00">aws_old_data_firms_dag</text>
<g id="clust1" class="cluster">
<title>cluster_load_old_firms_data</title>
<polygon fill="#6495ed" fill-opacity="0.498039" stroke="#000000" points="134,-145 134,-220 403.5,-220 403.5,-145 134,-145"/>
<text text-anchor="middle" x="268.75" y="-204.8" font-family="Times,serif" font-size="14.00">load_old_firms_data</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_load_script_files</title>
<polygon fill="#6495ed" fill-opacity="0.498039" stroke="#000000" points="134,-8 134,-137 509,-137 509,-8 134,-8"/>
<text text-anchor="middle" x="321.5" y="-121.8" font-family="Times,serif" font-size="14.00">load_script_files</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_run_quality_tests</title>
<polygon fill="#6495ed" fill-opacity="0.498039" stroke="#000000" points="1159,-95 1159,-170 1405,-170 1405,-95 1159,-95"/>
<text text-anchor="middle" x="1282" y="-154.8" font-family="Times,serif" font-size="14.00">run_quality_tests</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_submit_spark_to_emr</title>
<polygon fill="#6495ed" fill-opacity="0.498039" stroke="#000000" points="529,-95 529,-170 1139,-170 1139,-95 529,-95"/>
<text text-anchor="middle" x="834" y="-154.8" font-family="Times,serif" font-size="14.00">submit_spark_to_emr</text>
</g>
<!-- begin_execution -->
<g id="node1" class="node">
<title>begin_execution</title>
<path fill="#e8f7e4" stroke="#000000" d="M94,-149C94,-149 12,-149 12,-149 6,-149 0,-143 0,-137 0,-137 0,-125 0,-125 0,-119 6,-113 12,-113 12,-113 94,-113 94,-113 100,-113 106,-119 106,-125 106,-125 106,-137 106,-137 106,-143 100,-149 94,-149"/>
<text text-anchor="middle" x="53" y="-127.3" font-family="Times,serif" font-size="14.00">begin_execution</text>
</g>
<!-- load_old_firms_data.upstream_join_id -->
<g id="node3" class="node">
<title>load_old_firms_data.upstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="149" cy="-165" rx="7" ry="7"/>
</g>
<!-- begin_execution&#45;&gt;load_old_firms_data.upstream_join_id -->
<g id="edge1" class="edge">
<title>begin_execution&#45;&gt;load_old_firms_data.upstream_join_id</title>
<path fill="none" stroke="black" d="M104.03,-149.1C114.4,-152.85 124.57,-156.53 132.52,-159.4"/>
<polygon fill="black" stroke="black" points="131.46,-162.74 142.05,-162.85 133.84,-156.16 131.46,-162.74"/>
</g>
<!-- load_script_files.upstream_join_id -->
<g id="node6" class="node">
<title>load_script_files.upstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="149" cy="-93" rx="7" ry="7"/>
</g>
<!-- begin_execution&#45;&gt;load_script_files.upstream_join_id -->
<g id="edge2" class="edge">
<title>begin_execution&#45;&gt;load_script_files.upstream_join_id</title>
<path fill="none" stroke="black" d="M98.8,-112.89C111.17,-107.89 123.74,-102.81 133.08,-99.03"/>
<polygon fill="black" stroke="black" points="134.4,-102.27 142.36,-95.28 131.77,-95.78 134.4,-102.27"/>
</g>
<!-- end_execution -->
<g id="node2" class="node">
<title>end_execution</title>
<path fill="#e8f7e4" stroke="#000000" d="M1516,-139C1516,-139 1445,-139 1445,-139 1439,-139 1433,-133 1433,-127 1433,-127 1433,-115 1433,-115 1433,-109 1439,-103 1445,-103 1445,-103 1516,-103 1516,-103 1522,-103 1528,-109 1528,-115 1528,-115 1528,-127 1528,-127 1528,-133 1522,-139 1516,-139"/>
<text text-anchor="middle" x="1480.5" y="-117.3" font-family="Times,serif" font-size="14.00">end_execution</text>
</g>
<!-- load_old_firms_data.load_file_2021 -->
<g id="node5" class="node">
<title>load_old_firms_data.load_file_2021</title>
<path fill="#7545a1" stroke="#000000" d="M278,-189C278,-189 204,-189 204,-189 198,-189 192,-183 192,-177 192,-177 192,-165 192,-165 192,-159 198,-153 204,-153 204,-153 278,-153 278,-153 284,-153 290,-159 290,-165 290,-165 290,-177 290,-177 290,-183 284,-189 278,-189"/>
<text text-anchor="middle" x="241" y="-167.3" font-family="Times,serif" font-size="14.00">load_file_2021</text>
</g>
<!-- load_old_firms_data.upstream_join_id&#45;&gt;load_old_firms_data.load_file_2021 -->
<g id="edge5" class="edge">
<title>load_old_firms_data.upstream_join_id&#45;&gt;load_old_firms_data.load_file_2021</title>
<path fill="none" stroke="black" d="M156.19,-165.41C161.96,-165.8 171.23,-166.42 181.53,-167.1"/>
<polygon fill="black" stroke="black" points="181.43,-170.6 191.64,-167.78 181.9,-163.62 181.43,-170.6"/>
</g>
<!-- load_old_firms_data.downstream_join_id -->
<g id="node4" class="node">
<title>load_old_firms_data.downstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="388.5" cy="-165" rx="7" ry="7"/>
</g>
<!-- submit_spark_to_emr.upstream_join_id -->
<g id="node14" class="node">
<title>submit_spark_to_emr.upstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="544" cy="-121" rx="7" ry="7"/>
</g>
<!-- load_old_firms_data.downstream_join_id&#45;&gt;submit_spark_to_emr.upstream_join_id -->
<g id="edge3" class="edge">
<title>load_old_firms_data.downstream_join_id&#45;&gt;submit_spark_to_emr.upstream_join_id</title>
<path fill="none" stroke="black" d="M395.67,-164.49C413.67,-162.85 467.49,-156.86 509,-141 516.05,-138.31 523.33,-134.23 529.33,-130.45"/>
<polygon fill="black" stroke="black" points="531.6,-133.15 537.97,-124.69 527.71,-127.33 531.6,-133.15"/>
</g>
<!-- load_old_firms_data.load_file_2021&#45;&gt;load_old_firms_data.downstream_join_id -->
<g id="edge4" class="edge">
<title>load_old_firms_data.load_file_2021&#45;&gt;load_old_firms_data.downstream_join_id</title>
<path fill="none" stroke="black" d="M290.05,-169.02C318.01,-167.87 351.51,-166.48 371.06,-165.68"/>
<polygon fill="black" stroke="black" points="371.4,-169.17 381.25,-165.26 371.12,-162.17 371.4,-169.17"/>
</g>
<!-- load_script_files.start -->
<g id="node10" class="node">
<title>load_script_files.start</title>
<path fill="#e8f7e4" stroke="#000000" d="M256,-106C256,-106 226,-106 226,-106 220,-106 214,-100 214,-94 214,-94 214,-82 214,-82 214,-76 220,-70 226,-70 226,-70 256,-70 256,-70 262,-70 268,-76 268,-82 268,-82 268,-94 268,-94 268,-100 262,-106 256,-106"/>
<text text-anchor="middle" x="241" y="-84.3" font-family="Times,serif" font-size="14.00">start</text>
</g>
<!-- load_script_files.upstream_join_id&#45;&gt;load_script_files.start -->
<g id="edge11" class="edge">
<title>load_script_files.upstream_join_id&#45;&gt;load_script_files.start</title>
<path fill="none" stroke="black" d="M156.19,-92.66C165.95,-92.11 185.65,-91.02 203.5,-90.03"/>
<polygon fill="black" stroke="black" points="203.92,-93.51 213.71,-89.46 203.53,-86.52 203.92,-93.51"/>
</g>
<!-- load_script_files.downstream_join_id -->
<g id="node7" class="node">
<title>load_script_files.downstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="494" cy="-88" rx="7" ry="7"/>
</g>
<!-- load_script_files.downstream_join_id&#45;&gt;submit_spark_to_emr.upstream_join_id -->
<g id="edge7" class="edge">
<title>load_script_files.downstream_join_id&#45;&gt;submit_spark_to_emr.upstream_join_id</title>
<path fill="none" stroke="black" d="M500.14,-91.53C507.03,-96.27 519.53,-104.86 529.26,-111.55"/>
<polygon fill="black" stroke="black" points="527.53,-114.61 537.75,-117.39 531.5,-108.84 527.53,-114.61"/>
</g>
<!-- load_script_files.bootstrap&#45;actions.sh -->
<g id="node8" class="node">
<title>load_script_files.bootstrap&#45;actions.sh</title>
<path fill="#7545a1" stroke="#000000" d="M439,-52C439,-52 338,-52 338,-52 332,-52 326,-46 326,-40 326,-40 326,-28 326,-28 326,-22 332,-16 338,-16 338,-16 439,-16 439,-16 445,-16 451,-22 451,-28 451,-28 451,-40 451,-40 451,-46 445,-52 439,-52"/>
<text text-anchor="middle" x="388.5" y="-30.3" font-family="Times,serif" font-size="14.00">bootstrap&#45;actions.sh</text>
</g>
<!-- load_script_files.bootstrap&#45;actions.sh&#45;&gt;load_script_files.downstream_join_id -->
<g id="edge6" class="edge">
<title>load_script_files.bootstrap&#45;actions.sh&#45;&gt;load_script_files.downstream_join_id</title>
<path fill="none" stroke="black" d="M432.92,-52.04C439.07,-54.88 445.25,-57.91 451,-61 460.88,-66.3 471.51,-73.14 479.59,-78.61"/>
<polygon fill="black" stroke="black" points="477.77,-81.6 487.99,-84.41 481.75,-75.84 477.77,-81.6"/>
</g>
<!-- load_script_files.firms_spark_etl.py -->
<g id="node9" class="node">
<title>load_script_files.firms_spark_etl.py</title>
<path fill="#7545a1" stroke="#000000" d="M436,-106C436,-106 341,-106 341,-106 335,-106 329,-100 329,-94 329,-94 329,-82 329,-82 329,-76 335,-70 341,-70 341,-70 436,-70 436,-70 442,-70 448,-76 448,-82 448,-82 448,-94 448,-94 448,-100 442,-106 436,-106"/>
<text text-anchor="middle" x="388.5" y="-84.3" font-family="Times,serif" font-size="14.00">firms_spark_etl.py</text>
</g>
<!-- load_script_files.firms_spark_etl.py&#45;&gt;load_script_files.downstream_join_id -->
<g id="edge8" class="edge">
<title>load_script_files.firms_spark_etl.py&#45;&gt;load_script_files.downstream_join_id</title>
<path fill="none" stroke="black" d="M448.21,-88C458.63,-88 468.67,-88 476.59,-88"/>
<polygon fill="black" stroke="black" points="476.77,-91.5 486.77,-88 476.77,-84.5 476.77,-91.5"/>
</g>
<!-- load_script_files.start&#45;&gt;load_script_files.bootstrap&#45;actions.sh -->
<g id="edge9" class="edge">
<title>load_script_files.start&#45;&gt;load_script_files.bootstrap&#45;actions.sh</title>
<path fill="none" stroke="black" d="M268.01,-78.35C285.02,-72.03 307.95,-63.52 329.17,-55.65"/>
<polygon fill="black" stroke="black" points="330.62,-58.85 338.77,-52.08 328.18,-52.28 330.62,-58.85"/>
</g>
<!-- load_script_files.start&#45;&gt;load_script_files.firms_spark_etl.py -->
<g id="edge10" class="edge">
<title>load_script_files.start&#45;&gt;load_script_files.firms_spark_etl.py</title>
<path fill="none" stroke="black" d="M268.01,-88C282.22,-88 300.56,-88 318.58,-88"/>
<polygon fill="black" stroke="black" points="318.83,-91.5 328.83,-88 318.83,-84.5 318.83,-91.5"/>
</g>
<!-- run_quality_tests.upstream_join_id -->
<g id="node11" class="node">
<title>run_quality_tests.upstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="1174" cy="-121" rx="7" ry="7"/>
</g>
<!-- run_quality_tests.check_if_data_exists -->
<g id="node13" class="node">
<title>run_quality_tests.check_if_data_exists</title>
<path fill="#89da59" stroke="#000000" d="M1335,-139C1335,-139 1229,-139 1229,-139 1223,-139 1217,-133 1217,-127 1217,-127 1217,-115 1217,-115 1217,-109 1223,-103 1229,-103 1229,-103 1335,-103 1335,-103 1341,-103 1347,-109 1347,-115 1347,-115 1347,-127 1347,-127 1347,-133 1341,-139 1335,-139"/>
<text text-anchor="middle" x="1282" y="-117.3" font-family="Times,serif" font-size="14.00">check_if_data_exists</text>
</g>
<!-- run_quality_tests.upstream_join_id&#45;&gt;run_quality_tests.check_if_data_exists -->
<g id="edge14" class="edge">
<title>run_quality_tests.upstream_join_id&#45;&gt;run_quality_tests.check_if_data_exists</title>
<path fill="none" stroke="black" d="M1181,-121C1186.74,-121 1196.08,-121 1206.8,-121"/>
<polygon fill="black" stroke="black" points="1206.98,-124.5 1216.98,-121 1206.98,-117.5 1206.98,-124.5"/>
</g>
<!-- run_quality_tests.downstream_join_id -->
<g id="node12" class="node">
<title>run_quality_tests.downstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="1390" cy="-121" rx="7" ry="7"/>
</g>
<!-- run_quality_tests.downstream_join_id&#45;&gt;end_execution -->
<g id="edge13" class="edge">
<title>run_quality_tests.downstream_join_id&#45;&gt;end_execution</title>
<path fill="none" stroke="black" d="M1397.08,-121C1402.88,-121 1412.25,-121 1422.64,-121"/>
<polygon fill="black" stroke="black" points="1422.82,-124.5 1432.82,-121 1422.82,-117.5 1422.82,-124.5"/>
</g>
<!-- run_quality_tests.check_if_data_exists&#45;&gt;run_quality_tests.downstream_join_id -->
<g id="edge12" class="edge">
<title>run_quality_tests.check_if_data_exists&#45;&gt;run_quality_tests.downstream_join_id</title>
<path fill="none" stroke="black" d="M1347.11,-121C1356.49,-121 1365.39,-121 1372.55,-121"/>
<polygon fill="black" stroke="black" points="1372.75,-124.5 1382.75,-121 1372.75,-117.5 1372.75,-124.5"/>
</g>
<!-- submit_spark_to_emr.create_cluster -->
<g id="node17" class="node">
<title>submit_spark_to_emr.create_cluster</title>
<path fill="#f9c915" stroke="#000000" d="M667,-139C667,-139 599,-139 599,-139 593,-139 587,-133 587,-127 587,-127 587,-115 587,-115 587,-109 593,-103 599,-103 599,-103 667,-103 667,-103 673,-103 679,-109 679,-115 679,-115 679,-127 679,-127 679,-133 673,-139 667,-139"/>
<text text-anchor="middle" x="633" y="-117.3" font-family="Times,serif" font-size="14.00">create_cluster</text>
</g>
<!-- submit_spark_to_emr.upstream_join_id&#45;&gt;submit_spark_to_emr.create_cluster -->
<g id="edge19" class="edge">
<title>submit_spark_to_emr.upstream_join_id&#45;&gt;submit_spark_to_emr.create_cluster</title>
<path fill="none" stroke="black" d="M551.26,-121C557.1,-121 566.46,-121 576.76,-121"/>
<polygon fill="black" stroke="black" points="576.85,-124.5 586.85,-121 576.85,-117.5 576.85,-124.5"/>
</g>
<!-- submit_spark_to_emr.downstream_join_id -->
<g id="node15" class="node">
<title>submit_spark_to_emr.downstream_join_id</title>
<ellipse fill="CornflowerBlue" stroke="#000000" cx="1124" cy="-121" rx="7" ry="7"/>
</g>
<!-- submit_spark_to_emr.downstream_join_id&#45;&gt;run_quality_tests.upstream_join_id -->
<g id="edge17" class="edge">
<title>submit_spark_to_emr.downstream_join_id&#45;&gt;run_quality_tests.upstream_join_id</title>
<path fill="none" stroke="black" d="M1131.28,-121C1137.71,-121 1147.98,-121 1156.72,-121"/>
<polygon fill="black" stroke="black" points="1156.88,-124.5 1166.88,-121 1156.88,-117.5 1156.88,-124.5"/>
</g>
<!-- submit_spark_to_emr.add_steps -->
<g id="node16" class="node">
<title>submit_spark_to_emr.add_steps</title>
<path fill="#f9c915" stroke="#000000" d="M773,-139C773,-139 727,-139 727,-139 721,-139 715,-133 715,-127 715,-127 715,-115 715,-115 715,-109 721,-103 727,-103 727,-103 773,-103 773,-103 779,-103 785,-109 785,-115 785,-115 785,-127 785,-127 785,-133 779,-139 773,-139"/>
<text text-anchor="middle" x="750" y="-117.3" font-family="Times,serif" font-size="14.00">add_steps</text>
</g>
<!-- submit_spark_to_emr.watch_firms_step -->
<g id="node19" class="node">
<title>submit_spark_to_emr.watch_firms_step</title>
<path fill="#66c3ff" stroke="#000000" d="M922,-139C922,-139 833,-139 833,-139 827,-139 821,-133 821,-127 821,-127 821,-115 821,-115 821,-109 827,-103 833,-103 833,-103 922,-103 922,-103 928,-103 934,-109 934,-115 934,-115 934,-127 934,-127 934,-133 928,-139 922,-139"/>
<text text-anchor="middle" x="877.5" y="-117.3" font-family="Times,serif" font-size="14.00">watch_firms_step</text>
</g>
<!-- submit_spark_to_emr.add_steps&#45;&gt;submit_spark_to_emr.watch_firms_step -->
<g id="edge15" class="edge">
<title>submit_spark_to_emr.add_steps&#45;&gt;submit_spark_to_emr.watch_firms_step</title>
<path fill="none" stroke="black" d="M785.29,-121C793.31,-121 802.11,-121 810.98,-121"/>
<polygon fill="black" stroke="black" points="811,-124.5 821,-121 811,-117.5 811,-124.5"/>
</g>
<!-- submit_spark_to_emr.create_cluster&#45;&gt;submit_spark_to_emr.add_steps -->
<g id="edge16" class="edge">
<title>submit_spark_to_emr.create_cluster&#45;&gt;submit_spark_to_emr.add_steps</title>
<path fill="none" stroke="black" d="M679.12,-121C687.44,-121 696.12,-121 704.42,-121"/>
<polygon fill="black" stroke="black" points="704.68,-124.5 714.68,-121 704.68,-117.5 704.68,-124.5"/>
</g>
<!-- submit_spark_to_emr.terminate_cluster -->
<g id="node18" class="node">
<title>submit_spark_to_emr.terminate_cluster</title>
<path fill="#f9c915" stroke="#000000" d="M1069,-139C1069,-139 982,-139 982,-139 976,-139 970,-133 970,-127 970,-127 970,-115 970,-115 970,-109 976,-103 982,-103 982,-103 1069,-103 1069,-103 1075,-103 1081,-109 1081,-115 1081,-115 1081,-127 1081,-127 1081,-133 1075,-139 1069,-139"/>
<text text-anchor="middle" x="1025.5" y="-117.3" font-family="Times,serif" font-size="14.00">terminate_cluster</text>
</g>
<!-- submit_spark_to_emr.terminate_cluster&#45;&gt;submit_spark_to_emr.downstream_join_id -->
<g id="edge18" class="edge">
<title>submit_spark_to_emr.terminate_cluster&#45;&gt;submit_spark_to_emr.downstream_join_id</title>
<path fill="none" stroke="black" d="M1081.23,-121C1090.61,-121 1099.66,-121 1106.92,-121"/>
<polygon fill="black" stroke="black" points="1106.92,-124.5 1116.92,-121 1106.92,-117.5 1106.92,-124.5"/>
</g>
<!-- submit_spark_to_emr.watch_firms_step&#45;&gt;submit_spark_to_emr.terminate_cluster -->
<g id="edge20" class="edge">
<title>submit_spark_to_emr.watch_firms_step&#45;&gt;submit_spark_to_emr.terminate_cluster</title>
<path fill="none" stroke="black" d="M934.11,-121C942.36,-121 950.93,-121 959.35,-121"/>
<polygon fill="black" stroke="black" points="959.52,-124.5 969.52,-121 959.52,-117.5 959.52,-124.5"/>
</g>
</g>
</svg>
